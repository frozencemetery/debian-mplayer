diff -pruN 2:1.0~rc1-0ubuntu3/debian/changelog 2:1.0~rc1-0ubuntu4/debian/changelog
--- 2:1.0~rc1-0ubuntu3/debian/changelog	2007-03-07 01:22:13.000000000 +0000
+++ 2:1.0~rc1-0ubuntu4/debian/changelog	2007-03-07 01:22:11.000000000 +0000
@@ -1,3 +1,13 @@
+mplayer (2:1.0~rc1-0ubuntu4) feisty; urgency=low
+
+  * SECURITY UPDATE: DMO decoder heap overflow.
+  * loader/dmo/DMO_VideoDecoder.c: added upstream fix.
+  * References
+    http://svn.mplayerhq.hu/mplayer/trunk/loader/dmo/DMO_VideoDecoder.c?r1=22019&r2=22204
+    CVE-2007-1246
+
+ -- Kees Cook <kees@ubuntu.com>  Tue,  6 Mar 2007 15:21:26 -0800
+
 mplayer (2:1.0~rc1-0ubuntu3) feisty; urgency=low
 
   * debian/rules:
diff -pruN 2:1.0~rc1-0ubuntu3/loader/dmo/DMO_VideoDecoder.c 2:1.0~rc1-0ubuntu4/loader/dmo/DMO_VideoDecoder.c
--- 2:1.0~rc1-0ubuntu3/loader/dmo/DMO_VideoDecoder.c	2007-02-03 04:00:24.000000000 +0000
+++ 2:1.0~rc1-0ubuntu4/loader/dmo/DMO_VideoDecoder.c	2007-03-07 01:22:11.000000000 +0000
@@ -121,6 +121,7 @@ DMO_VideoDecoder * DMO_VideoDecoder_Open
      
         this->iv.m_bh = malloc(bihs);
         memcpy(this->iv.m_bh, format, bihs);
+	this->iv.m_bh->biSize = bihs;
 
         this->iv.m_State = STOP;
         //this->iv.m_pFrame = 0;
