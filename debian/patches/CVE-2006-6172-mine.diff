diff -ur mplayer-1.0~rc1-10/stream/realrtsp/asmrp.c mplayer-1.0~rc1-11/stream/realrtsp/asmrp.c
--- mplayer-1.0~rc1-10/stream/realrtsp/asmrp.c	2006-10-23 00:32:25.000000000 +0200
+++ mplayer-1.0~rc1-11/stream/realrtsp/asmrp.c	2006-12-28 22:48:27.000000000 +0100
@@ -628,7 +628,7 @@
   return ret;
 }
 
-static int asmrp_eval (asmrp_t *p, int *matches) {
+static int asmrp_eval (asmrp_t *p, int *matches, int matchsize) {
 
   int rule_num, num_matches;
 
@@ -639,7 +639,7 @@
   asmrp_get_sym (p);
 
   rule_num = 0; num_matches = 0;
-  while (p->sym != ASMRP_SYM_EOF) {
+  while (p->sym != ASMRP_SYM_EOF && num_matches < matchsize - 1) {
 
     if (asmrp_rule (p)) {
 #ifdef LOG
@@ -656,7 +656,7 @@
   return num_matches;
 }
 
-int asmrp_match (const char *rules, int bandwidth, int *matches) {
+int asmrp_match (const char *rules, int bandwidth, int *matches, int matchsize) {
 
   asmrp_t *p;
   int      num_matches;
@@ -668,7 +668,7 @@
   asmrp_set_id (p, "Bandwidth", bandwidth);
   asmrp_set_id (p, "OldPNMPlayer", 0);
 
-  num_matches = asmrp_eval (p, matches);
+  num_matches = asmrp_eval (p, matches, matchsize);
 
   asmrp_dispose (p);
 
Only in mplayer-1.0~rc1-11/stream/realrtsp: asmrp.c.orig
diff -ur mplayer-1.0~rc1-10/stream/realrtsp/asmrp.h mplayer-1.0~rc1-11/stream/realrtsp/asmrp.h
--- mplayer-1.0~rc1-10/stream/realrtsp/asmrp.h	2006-10-23 00:32:25.000000000 +0200
+++ mplayer-1.0~rc1-11/stream/realrtsp/asmrp.h	2006-12-28 22:48:35.000000000 +0100
@@ -40,6 +40,6 @@
 #ifndef HAVE_ASMRP_H
 #define HAVE_ASMRP_H
 
-int asmrp_match (const char *rules, int bandwidth, int *matches) ;
+int asmrp_match (const char *rules, int bandwidth, int *matches, int matchesizxe) ;
 
 #endif
Only in mplayer-1.0~rc1-11/stream/realrtsp: asmrp.h.orig
diff -ur mplayer-1.0~rc1-10/stream/realrtsp/real.c mplayer-1.0~rc1-11/stream/realrtsp/real.c
--- mplayer-1.0~rc1-10/stream/realrtsp/real.c	2006-10-23 00:32:25.000000000 +0200
+++ mplayer-1.0~rc1-11/stream/realrtsp/real.c	2006-12-28 22:49:48.000000000 +0100
@@ -276,7 +276,7 @@
 #ifdef LOG
     printf("calling asmrp_match with:\n%s\n%u\n", desc->stream[i]->asm_rule_book, bandwidth);
 #endif
-    n=asmrp_match(desc->stream[i]->asm_rule_book, bandwidth, rulematches);
+    n=asmrp_match(desc->stream[i]->asm_rule_book, bandwidth, rulematches, sizeof(rulematches)/sizeof(rulematches[0]));
     for (j=0; j<n; j++) {
 #ifdef LOG
       printf("asmrp rule match: %u for stream %u\n", rulematches[j], desc->stream[i]->stream_id);
Only in mplayer-1.0~rc1-11/stream/realrtsp: real.c~
Only in mplayer-1.0~rc1-11/stream/realrtsp: real.c.orig
Only in mplayer-1.0~rc1-11/stream/realrtsp: real.c.rej
